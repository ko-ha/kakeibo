<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>家計簿</title>
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="main.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/axios@0.21.1/dist/axios.min.js"></script>
</head>

<body>
    <div class="rp-top">
        <h3>SPENDING</h3>
    </div>

    <div class="rp-middle">

        <table style="width: 80%; display: block; height: 100%; overflow-y: scroll">
            <thead>
                <tr class="labels">
                    <th class="title-date">DATE</th>
                    <th class="title-category">CATEGORY</th>
                    <th class="title-contents">CONTENTS</h4>
                    <th class="title-price">PRICE</h4>
                    <th class="title-memo">MEMO</h4>
                </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
    </div>

    <div class="rp-bottom">
        <div class="btm-button">
            <form method="GET" action="index.html" class="home">
                <input type="submit" value="HOME" class="rp-btn home-btn">
            </form>
            <form method="GET" action="kakeibo3.html" class="record">
                <input type="submit" value="RECORD" class="rp-btn record-btn">
            </form>
        </div>
    </div>

    <script>
        const url = 'https://script.google.com/macros/s/AKfycbw-xnI-B0prbFKfMsFS1Tn71kgnzqi_NHsIeqwXKHzNAn6Q_JxBblWS/exec'

        async function getData() {
            var { data, status } = await axios.get(url);
            if (status !== 200) return console.log('failed');
            return data
        }

        async function main() {
            const data = await getData()
            const table = document.querySelector('tbody')
            for (item of data) {
                const {
                    date,
                    category,
                    name,
                    price,
                    note
                } = item

                const tr = document.createElement('tr')
                const row = [formatDate(date), category, name, price, note].map(x => createCell(x))
                tr.append(...row)
                table.appendChild(tr)
            }
        }

        function createCell(value) {
            const cell = document.createElement('td')
            cell.innerText = value
            return cell
        }

        function formatDate(x) {
            const newDate = x.substring(0, 10);
            return newDate;
        }

        main()
    </script>
</body>


</html>


<!--
    ・最初のページに戻るボタン
    ・記入したら一覧ページに飛ぶ、そこで続けて記入できるボタンを造る
-->